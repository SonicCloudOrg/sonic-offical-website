import{_ as e,o as s,c as a,a as n}from"./app.57a3dbd1.js";const y=JSON.parse('{"title":"Switch WebView","description":"","frontmatter":{"contributors":["ZhouYixun"]},"headers":[{"level":2,"title":"Precautions","slug":"precautions","link":"#precautions","children":[]},{"level":2,"title":"About ChromeDriver","slug":"about-chromedriver","link":"#about-chromedriver","children":[]},{"level":2,"title":"Find AndroidProcess","slug":"find-androidprocess","link":"#find-androidprocess","children":[{"level":3,"title":"Development provides AndroidManifest.xml","slug":"development-provides-androidmanifest-xml","link":"#development-provides-androidmanifest-xml","children":[]},{"level":3,"title":"Manual lookup","slug":"manual-lookup","link":"#manual-lookup","children":[]}]},{"level":2,"title":"Switch Handle","slug":"switch-handle","link":"#switch-handle","children":[]},{"level":2,"title":"Control operation","slug":"control-operation","link":"#control-operation","children":[]}],"relativePath":"en/doc/doc-to-webview.md","lastUpdated":1716537034000}'),o={name:"en/doc/doc-to-webview.md"},t=n(`<h1 id="switch-webview" tabindex="-1">Switch WebView <a class="header-anchor" href="#switch-webview" aria-hidden="true">#</a></h1><p>Precautions and teaching related to switching WebView.</p><h2 id="precautions" tabindex="-1">Precautions <a class="header-anchor" href="#precautions" aria-hidden="true">#</a></h2><p>Starting from v2.0.0-beta, when switching WebView, make sure:</p><ol><li>The WebView page has been opened</li><li>The App under test has enabled the Debug switch of WebView. (If it is WeChat&#39;s H5, small programs, etc., you need to make sure that WeChat&#39;s debugx5 is turned on)</li></ol><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">webView</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setWebContentsDebuggingEnabled</span><span style="color:#89DDFF;">(true);</span></span>
<span class="line"></span></code></pre></div><ol start="3"><li>[Web page debugging] on the remote control page can see the corresponding WebView</li></ol><h2 id="about-chromedriver" tabindex="-1">About ChromeDriver <a class="header-anchor" href="#about-chromedriver" aria-hidden="true">#</a></h2><p>Starting from v2.0.0-beta, Sonic will automatically match and download the ChromeDriver corresponding to the Chrome version of WebView, which is compatible with about 80-85% of the versions.</p><p>However, the lack of some old Chrome versions or M1 versions may cause the automatic download to fail. At this time, we need to manually add the chromeDriver file to the <strong>webview</strong> directory of the Agent. Example: The Chrome protocol version of the tested WebView is 77.0.3865.10, we need to rename the corresponding version of chromeDriver to</p><p>Mac OS X or Linux:</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">77.0.3865.10_chromedriver</span></span>
<span class="line"></span></code></pre></div><p>Windows:</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">77.0.3865.10_chromedriver.exe</span></span>
<span class="line"></span></code></pre></div><h2 id="find-androidprocess" tabindex="-1">Find AndroidProcess <a class="header-anchor" href="#find-androidprocess" aria-hidden="true">#</a></h2><p>When switching WebView pages, there is an option of AndroidProcess. Generally, the process corresponding to the package name is used by default. However, if the WebView is placed in multiple processes (such as WeChat H5), the switching will fail. At this time, we need to specify the process.</p><h3 id="development-provides-androidmanifest-xml" tabindex="-1">Development provides AndroidManifest.xml <a class="header-anchor" href="#development-provides-androidmanifest-xml" aria-hidden="true">#</a></h3><p>If your development provides <strong>AndroidManifest.xml</strong> , take <strong>org.sonic.test</strong> as an example:</p><div class="language-xml"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">activity</span></span>
<span class="line"><span style="color:#89DDFF;">     </span><span style="color:#C792EA;">android</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;">name</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">.Hello</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">     </span><span style="color:#C792EA;">android</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;">process</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">:helloworld</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> /&gt;</span></span>
<span class="line"></span></code></pre></div><p>Then AndroidProcess is <strong>org.sonic.test:helloworld</strong></p><h3 id="manual-lookup" tabindex="-1">Manual lookup <a class="header-anchor" href="#manual-lookup" aria-hidden="true">#</a></h3><p>If the app is a third-party app or the development cannot provide AndroidManifest.xml, we can also search it manually. Take <strong>com.android.browser</strong> as an example (replace com.android.browser with your app package name under test):</p><ol><li>Open the WebView page</li><li>Input command</li></ol><p>Windows:</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">adb</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">shell</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ps</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">findstr</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">com.android.browser</span></span>
<span class="line"></span></code></pre></div><p>Mac OS X or Linux:</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">adb</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">shell</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ps</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">grep</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">com.android.browser</span></span>
<span class="line"></span></code></pre></div><p>you will get output like</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">u0_a90</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">8907</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">517</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2321912</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">340180</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">S</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">com.android.browser</span></span>
<span class="line"><span style="color:#FFCB6B;">u0_a90</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">9252</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">517</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2261048</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">293056</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">S</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">com.android.browser:swan0</span></span>
<span class="line"></span></code></pre></div><ol start="3"><li>Then com.android.browser:swan0 is AndroidProcess. If there are multiple processes, you need to try them one by one.</li></ol><h2 id="switch-handle" tabindex="-1">Switch Handle <a class="header-anchor" href="#switch-handle" aria-hidden="true">#</a></h2><p>Generally, a WebView process has only one page, but there are also situations where multiple pages are shared, just like our browser has multiple Tab scenarios. At this time, after we switch WebView, the first Tab window is entered by default. If it is not the window we need to test, we need to switch.</p><p>Take WeChat H5 as an example:</p><ol><li>Use AndroidProcess to switch WebView for <a href="http://com.tencent.mm" target="_blank" rel="noreferrer">com.tencent.mm</a>:tools (some WeChat version is <a href="http://com.tencent.mm" target="_blank" rel="noreferrer">com.tencent.mm</a>:appbrand0 ).</li><li>At this time, we get the title of the page, and we will find that the window switched by default is the [Search] window of WeChat.</li><li>Then we use the [Switch Handle] step to enter the title of the target page. (Starting from v2.1.0, you can also enter the page address of the page or the subscript of the Handle array to locate the target Handle)</li><li>Then we can switch to our desired page and start UI automation.</li></ol><h2 id="control-operation" tabindex="-1">Control operation <a class="header-anchor" href="#control-operation" aria-hidden="true">#</a></h2><p>Control positioning and operation are based on <a href="https://github.com/SeleniumHQ/selenium" target="_blank" rel="noreferrer">Selenium</a> framework for UI automation, positioning tutorials and related knowledge are no longer taught in detail here.</p>`,36),l=[t];function r(p,i,c,d,h,C){return s(),a("div",null,l)}const m=e(o,[["render",r]]);export{y as __pageData,m as default};
