import{_ as e,o,c as t,a as n}from"./app.57a3dbd1.js";const s="/assets/eve.56b532f8.jpg",y=JSON.parse('{"title":"Agent side deployment","description":"","frontmatter":{"contributors":["ZhouYixun","soniclei","shinyvince","mmagi"]},"headers":[{"level":2,"title":"jar deployment","slug":"jar-deployment","link":"#jar-deployment","children":[]},{"level":2,"title":"Docker deployment","slug":"docker-deployment","link":"#docker-deployment","children":[]},{"level":2,"title":"Frequently Asked Questions (Q&A)","slug":"frequently-asked-questions-q-a","link":"#frequently-asked-questions-q-a","children":[]}],"relativePath":"en/deploy/agent-deploy.md","lastUpdated":1716537034000}'),a={name:"en/deploy/agent-deploy.md"},l=n(`<h1 id="agent-side-deployment" tabindex="-1">Agent side deployment <a class="header-anchor" href="#agent-side-deployment" aria-hidden="true">#</a></h1><p>This article will introduce how to deploy the Agent side.</p><div class="tip custom-block"><p class="custom-block-title">note</p><p>Remember that only one Agent can be deployed on one host, the Key of each Agent cannot be reused, and multiple devices can be connected to the same Agent.</p><p>In order to use it normally, please keep it consistent with the server version.</p><p>Considering scenarios such as bandwidth consumption and data transmission speed during remote control, it is recommended that the Agent use a wired network environment instead of a wireless network.</p></div><h2 id="jar-deployment" tabindex="-1">jar deployment <a class="header-anchor" href="#jar-deployment" aria-hidden="true">#</a></h2><p>This method will deploy Agent, Appium and other environments with local jar packages.</p><ol><li><strong>Some JDKs are known to be incompatible. Sonic officially recommends using JDK17</strong>, you can go <a href="https://docs.aws.amazon.com/corretto/latest/corretto-17-ug/downloads-list.html" target="_blank" rel="noreferrer">here</a> to install the downloads.</li><li>Add an Agent from the [Agent Center] of the deployed front-end interface [Device Center], and record the Key of the Agent.</li></ol><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>From <code>v2.5.3</code>, in order to reduce user deployment costs, Agent has built-in adb under the <code>plugins</code> folder.</p><p>However, it is known that multiple adb-servers working at the same time will cause preemption problems, so if you have other adb-servers working locally and want to use your existing adb or the version is lower than v2.5.3, you need to add these two steps:</p><ol><li>Set the Android SDK to the system environment variable, named ANDROID_HOME. Open SDKManager and download <strong>platform-tools</strong>. Make sure the platform-tools directory exists and the adb command is available.</li><li>Add ANDROID_HOME, ANDROID_HOME/platform-tools to the system PATH.</li></ol></div><ol start="3"><li>Select <strong>PC corresponding platform zip</strong> to download and unzip to any directory (marked as <strong>working directory</strong>, <strong>if the following acceleration link fails</strong>, please go to <a href="https://github.com/SonicCloudOrg/sonic-agent/releases" target="_blank">here</a> download)</li></ol><div class="info custom-block"><p class="custom-block-title">Linux</p><p>ðŸ‘‰ <a href="https://ghproxy.com/https://github.com/SonicCloudOrg/sonic-agent/releases/download/v2.6.4/sonic-agent-v2.6.4-linux_x86.zip" target="_blank">sonic-agent-v2.6.4-linux_x86.zip</a></p><p>ðŸ‘‰ <a href="https://ghproxy.com/https://github.com/SonicCloudOrg/sonic-agent/releases/download/v2.6.4/sonic-agent-v2.6.4-linux_x86_64.zip" target="_blank">sonic-agent-v2.6.4-linux_x86_64.zip</a></p><p>ðŸ‘‰ <a href="https://ghproxy.com/https://github.com/SonicCloudOrg/sonic-agent/releases/download/v2.6.4/sonic-agent-v2.6.4-linux_arm64.zip" target="_blank">sonic-agent-v2.6.4-linux_arm64.zip</a></p></div><div class="info custom-block"><p class="custom-block-title">Macosx</p><p>ðŸ‘‰ <a href="https://ghproxy.com/https://github.com/SonicCloudOrg/sonic-agent/releases/download/v2.6.4/sonic-agent-v2.6.4-macosx_x86_64.zip" target="_blank">sonic-agent-v2.6.4-macosx_x86_64.zip</a></p><p>ðŸ‘‰ <a href="https://ghproxy.com/https://github.com/SonicCloudOrg/sonic-agent/releases/download/v2.6.4/sonic-agent-v2.6.4-macosx_arm64.zip" target="_blank">sonic-agent-v2.6.4-macosx_arm64.zip</a></p></div><div class="info custom-block"><p class="custom-block-title">Windows</p><p>ðŸ‘‰ <a href="https://ghproxy.com/https://github.com/SonicCloudOrg/sonic-agent/releases/download/v2.6.4/sonic-agent-v2.6.4-windows_x86.zip" target="_blank">sonic-agent-v2.6.4-windows_x86.zip</a></p><p>ðŸ‘‰ <a href="https://ghproxy.com/https://github.com/SonicCloudOrg/sonic-agent/releases/download/v2.6.4/sonic-agent-v2.6.4-windows_x86_64.zip" target="_blank">sonic-agent-v2.6.4-windows_x86_64.zip</a></p></div><ol start="4"><li>Grant all permissions to the <strong>working directory</strong>, and then make sure that the decompressed mini, config, plugins folders are at the same level as the jar</li></ol><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">sudo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">chmod</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-R</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">777</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">xxxxx</span></span>
<span class="line"></span></code></pre></div><ol start="5"><li>Modify the configuration information of <strong>application-sonic-agent.yml</strong> in the config folder and save it.</li><li>Execute the following commands under the path of <strong>Working Directory</strong>.</li></ol><div class="tip custom-block"><p class="custom-block-title">TIP</p><ol><li>If you are a <code>Windows</code> user, please enter <code>chcp 65001</code> in the console and press Enter, and then enter the following command</li></ol><p>In addition, if you need to use the Python custom script function, you also need to enter <code>set PYTHONIOENCODING=UTF-8</code> in the command prompt before entering the following command to avoid garbled output from the Python script.</p><ol start="2"><li>If you are a <code>Macosx</code> user, please check the common question Q1 below for configuration before continuing with the following instructions</li></ol></div><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">java</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-Dfile.encoding=utf-8</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-jar</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">sonic-agent-xxxx.jar</span></span>
<span class="line"></span></code></pre></div><ol start="7"><li>Deployment complete! You can go to the device to access document (please place the device vertically or flatly, and rotate it left and right may affect the coordinate positioning).</li></ol><h2 id="docker-deployment" tabindex="-1">Docker deployment <a class="header-anchor" href="#docker-deployment" aria-hidden="true">#</a></h2><div class="danger custom-block"><p class="custom-block-title">warning</p><p>Docker deployment is only available for Ubuntu! Only available for Ubuntu! Only available for Ubuntu!</p><p>For non-Ubuntu systems, please use the above <strong>jar method to deploy</strong>!</p></div><p>This method will deploy the Agent and the required environment at one time.</p><p>Preparatory work: Docker, Sonic front and back ends are deployed</p><ol><li>Add an Agent from the [Agent Center] of the deployed front-end interface [Device Center], and record the Key of the Agent.</li><li><a href="https://ghproxy.com/https://github.com/SonicCloudOrg/sonic-agent/releases/download/v2.6.4/docker-compose.yml" target="_blank" rel="noreferrer">Click here</a> to download the latest docker-compose. yml, refer to the comments to modify the content inside. (If the acceleration link fails, please go to <a href="https://github.com/SonicCloudOrg/sonic-agent/releases" target="_black">here</a> to download)</li><li>Execute the following instructions (change the parameters by yourself according to the prompts).</li></ol><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker-compose</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">up</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-d</span></span>
<span class="line"></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">If you are a user from mainland China and access to DockerHub is slow, you can choose one of the following two points:</p><ul><li>Configure domestic accelerated image sources (recommended)</li><li><a href="https://ghproxy.com/https://github.com/SonicCloudOrg/sonic-agent/releases/download/v2.6.4/docker-compose-zh.yml" target="_blank"> Click here</a> to download docker-compose-zh.yml and execute the following instructions to directly use the accelerated image (not recommended, the acceleration source may be unstable or the network fluctuates, and docker-compose -f docker-compose- zh.yml down)</li></ul><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker-compose</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-f</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker-compose-zh.yml</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">up</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-d</span></span>
<span class="line"></span></code></pre></div></div><ol start="4"><li>Deployment is complete! You can go to the device to access document .</li><li>(Appendix) If you are not familiar with Docker, it is recommended to use jar deployment.</li></ol><h2 id="frequently-asked-questions-q-a" tabindex="-1">Frequently Asked Questions (Q&amp;A) <a class="header-anchor" href="#frequently-asked-questions-q-a" aria-hidden="true">#</a></h2><p>Q1: Are there any precautions for deploying on Mac?</p><p>A1: You need to trust the source of Sonic, otherwise some plugins will not start properly.</p><ol><li>Terminal input</li></ol><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">sudo spctl --master-disable</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><ol start="2"><li>[Security and Privacy] Release any source permissions. <img src="`+s+'" alt="eve"></li></ol><hr><p>Q2: Obviously configured ANDROID_HOME, and adb is available, why is it still not detected ANDROID_HOME?</p><p>A2: After configuring ANDROID_HOME, PATH also needs to be configured. Verify that <code>echo %ANDROID_HOME%</code> (win) or <code>echo $ANDROID_HOME</code> (mac or linux) outputs correctly.</p><hr><p>Q3: Check the log and find that it is not connected to the server, how to solve it?</p><p>A3: Mainly divided into a variety of situations:</p><ol><li>The Key configuration is incorrect, and a Key can only be used by one Agent.</li><li>All ip cannot use localhost, 127.0.0.1 and other configurations.</li></ol><hr><p>Q4: Check the logs and find that the time zone is incorrect, and the time zone of the host machine is correct. How to solve it?</p><p>A4: You can refer to <a href="https://sonic-cloud.wiki/d/2297" target="_blank" rel="noreferrer">this post</a></p><hr><p>Q5: There will be sonic-android-supply or other plug-in security pop-up windows when starting on Mac?</p><p>A5: It is recommended to follow the answer in Q1 above for the best solution, otherwise it can be solved in this way. Mac: System Preferences -&gt; Security &amp; Privacy -&gt; General, click Trust or Open anyway.</p><hr><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>For more questions, please go to ðŸ‘‰<a href="https://discord.gg/c9ZD6jSyTE" target="_blank" rel="noreferrer">Community</a>ðŸ‘ˆ to communicate</p></div>',46),i=[l];function r(c,p,d,h,m,u){return o(),t("div",null,i)}const f=e(a,[["render",r]]);export{y as __pageData,f as default};
